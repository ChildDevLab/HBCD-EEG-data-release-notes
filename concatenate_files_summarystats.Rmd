---
title: "concatenate_files"
author: "Savannah McNair"
date: "2025-01-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

necessary packages
```{r}
library(dplyr)
```

set cwd to file path, get ids 
```{r}
setwd("X:/Projects/hbcd/EEG/Main_Study/CBRAIN_8.14") #SM set to the location you downloaded the EEG files to. If you are using a Windows computer, you will need to change the direction of the slashes from '\' to '/'
cwd <- "X:/Projects/hbcd/EEG/Main_Study/CBRAIN_8.14/"
dccids <- list.files()
```

create sheets
```{r}
RS_power <- NULL
FACE_power <- NULL
FACE_trial <- NULL
MMN_power <- NULL
MMN_trial <- NULL
```

for each folder (ID), pull summary stats by task and condition
```{r}
for (x in dccids) {
  processed_data <- paste(x, "/ses-V03/eeg/processed_data", sep="")
  
  RS_power_file <- paste(cwd, processed_data, "/", x, "_ses-V03_task-RS_Power-summaryStats.csv", sep="")
  if (file.exists(RS_power_file)) {
    RS_power_sheet <- read.csv(RS_power_file)
    for (i in 1:nrow(RS_power_sheet)) {
      row <- RS_power_sheet[i, , drop = FALSE]
      RS_power <- rbind(RS_power, row)
    }
  } else {
    message(paste("RS Power file not found for", x))
  }
  
  FACE_summary_file <- paste(cwd, processed_data, "/", x, "_ses-V03_task-FACE_ERP-summaryStats.csv", sep="")
  if (file.exists(FACE_summary_file)) {
    FACE_summary_sheet <- read.csv(FACE_summary_file)
    for (i in 1:nrow(FACE_summary_sheet)) {
      row <- FACE_summary_sheet[i, , drop = FALSE]
      FACE_power <- rbind(FACE_power, row)
    }
  } else {
    message(paste("FACE file not found for", x))
  }
  
  MMN_summary_file <- paste(cwd, processed_data, "/", x, "_ses-V03_task-MMN_ERP-summaryStats.csv", sep="")
  if (file.exists(MMN_summary_file)) {
    MMN_summary_sheet <- read.csv(MMN_summary_file)
    for (i in 1:nrow(MMN_summary_sheet)) {
      row <- MMN_summary_sheet[i, , drop = FALSE]
      MMN_power <- rbind(MMN_power, row)
    }
  } else {
    message(paste("MMN file not found for", x))
  }
}

```


output df as a csv
```{r}
write.csv(FACE_power,"Z:/Dropboxes/SMcNair/SMcNair_Playground/HBCD/Data Release/outputs_concatenate_files/FACE_power.csv")
write.csv(RS_power,"Z:/Dropboxes/SMcNair/SMcNair_Playground/HBCD/Data Release/outputs_concatenate_files/RS_power.csv")
write.csv(MMN_power,"Z:/Dropboxes/SMcNair/SMcNair_Playground/HBCD/Data Release/outputs_concatenate_files/MMN_power.csv")
```

