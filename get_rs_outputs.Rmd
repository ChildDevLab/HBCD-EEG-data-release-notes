---
title: "get_rs_outputs"
author: "Trisha Maheshwari & Savannah McNair"
date: "2025-01-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load in your paths:
directory_path is where you have saved your summary stats or trial measures data (the folder where the original data is downloaded to)
output_path is where you would like the outputs to get saved
```{r}
#SM set to the location you downloaded the EEG files to. If you are using a Windows computer, you will need to change the direction of the slashes from '\' to '/'
directory_path <- "X:/Projects/hbcd/EEG/Main_Study/CBRAIN_Outputs/DataReleaseIDs/"
output_path <- "Z:/Dropboxes/SMcNair/SMcNair_Playground/HBCD/Data Release/DataRelease_Githhub/test_cbrain_datarelease_deid/"
```

set cwd (current working directory) to file path, get a list of IDs
```{r}
setwd(directory_path) 
cwd <- directory_path
dccids <- list.files()
```

create sheets - these are the sheets this script will output
```{r}
RS_power <- NULL
```


for each folder (ID), pull summary stats by task and condition
```{r}
#for x (each ID), pull out the RS summary stats data and paste it into a new sheet, storing ID in a new column
for (x in dccids) {
  processed_data <- paste(x, "/ses-V03/eeg/processed_data", sep="")
 
  RS_power_file <- paste(cwd, processed_data, "/", x, "_ses-V03_task-RS_PowerSummaryStats.csv", sep="")
  if (file.exists(RS_power_file)) {
    RS_power_sheet <- read.csv(RS_power_file)
    for (i in 1:nrow(RS_power_sheet)) {
      row <- RS_power_sheet[i, , drop = FALSE]
      RS_power <- rbind(RS_power, row)
    }
  } else {
    message(paste("RS Power file not found for", x))
  }
  
}
```

output the dataframe containing concatenated summary stats as a csv
```{r}
write.csv(RS_power,paste(output_path,"RS_power.csv", sep="")) #Feel free to change the name of the file to however you would prefer it to be named, as a general example we have chosen "RS_Power.csv"
```

Output Guide:

column X: rows for each table (generated by R)
Frequency: frequency range for each single hertz bin 
SME: Standard measurement error (varying by task, time windows, and region of interest)
Mean_Power: the average power in the corresponding frequency bin
ID: participant ID

For more information on measures and outputs consult our documentation, links available in the main Github README
